<%- include('../partials/html-head') %>
<%- include('../partials/nav') %>

<main>
  <h1>Update Information</h1>
  <section class="data">
    <div class="card" style="width: 18rem;">
      <img src="<%= user.profile.avatar %>" class="card-img-top" alt="<%= user.profile.name %> avatar">
      <div class="card-body">
        <h5 class="card-title"><%= user.profile.name %></h5>
        <% console.dir(user.profile) %> 
        <p class="card-text">Mood:<%= user.profile.mood %></p>
      </div>
      <ul class="list-group list-group-flush">
        <li class="list-group-item">Friends:
          <% if(user.profile.friends?.length) {%>
            <% user.profile.friends.forEach(friend => { %>
                <button><%= friend.name %></button>
              </form>
            <% }) %>
          <% } else { %>
            You are alone!
          <% } %> 
        </li>
        <li class="list-group-item">Fishing: 
          <% if(user.profile.fishing?.length) {%>
            <% user.profile.fishing.forEach(fish => { %>
                <button><%= fish.name %></button>
              </form>
            <% }) %>
          <% } else { %>
            You caught none!
          <% } %>
        </li>
        <li class="list-group-item">Comments: 
          <% if(user.profile.comments?.length) {%>
            <% user.profile.comments.forEach(comment => { %>
                <button><%= comment.content %></button>
              </form>
            <% }) %>
          <% } else { %>
            You don't have any comment!
          <% } %>
        </li>
      </ul>
      <div class="card-body">
        <a href="/"><button>Back</button></a>
        <form 
          action="/users/<%= user._id %>/u?_method=DELETE" 
          method="POST"
        >
          <button>Delete</button>
        </form>
      </div>
    </div>
    <div>
      <form action="/users/<%= user._id %>/updateUser?_method=PUT" method="POST" id="edit-form">
        <label for="user-name">Name:</label>
        <input type="text" name="name" id="user-name" value="<%= user.profile.name %>">
        <label for="user-avatar">AvatarURL:</label>
        <textarea name="avatar" id="user-avatar" cols="30" rows="5"><%= user.profile.avatar %></textarea>
        <label for="user-mood">Mood:</label>
      <textarea name="mood" id="user-mood" cols="30" rows="5"><%= user.profile.mood %></textarea>
        <button type="submit">Update</button>
      </form>
    </div>
  </section>
</main>

<%- include('../partials/footer') %>