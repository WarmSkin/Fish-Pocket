<%- include('../partials/html-head') %>
<%- include('../partials/nav') %>

<main>
  <% if (user) { %>
    <section class="data">
      <div class="card" style="width: 20rem;">
        <img src="<%= profile.avatar %>" class="card-img-top" alt="<%= profile.name %> avatar">
        <div class="card-body">
          <h5 class="card-title"><%= profile.name %></h5>
          <p class="card-text">Mood:<%= profile.mood %></p>
        </div>
        <ul class="list-group list-group-flush">
          <li class="list-group-item">Friends:
            <% if(profile.friends?.length) {%>
              <% profile.friends.forEach(friend => { %>
                <a href="/users/<%= friend._id %>/friend"><button type="submit"><%= friend.name %></button></a>
              <% }) %>
            <% } else { %>
              You are alone!
            <% } %> 
          </li>
          <li class="list-group-item">Fishing: 
            <% if(profile.fishing?.length) {%>
              <% profile.fishing.forEach(fish => { %>
                  <button type="submit"><%= fish.name %></button>
              <% }) %>
            <% } else { %>
              You caught none!
            <% } %>
          </li>
          <li class="list-group-item">Comments: 
            <% if(profile.comments?.length) {%>
              <% profile.comments.forEach(comment => { %>
                <% if(comment.from !== profile.name) { %>
                  <button type="submit">
                    <p>
                      <%= comment.from %>: 
                      <%= comment.content %> 
                    </p>
                  </button>
                <% } %>  
              <% }) %>
            <% } else { %>
              You don't have any comment!
            <% } %>
          </li>
        </ul>
        <div class="card-body">
          <a href="/users/<%= user._id %>/edit"><button>Edit</button></a>
          <form 
            action="/users/<%= user._id %>/u?_method=DELETE" 
            method="POST"
          >
            <button>Delete</button>
          </form>
        </div>
      </div>
      <div>
        <form action="/users/<%= profile._id %>/fishing" method="POST" id="edit-form">
          <h1>Caught A Fish</h1>
          <select name="species">
            <% species.forEach(fishData => { %>
              <option value="<%= fishData._id %>">
                <%= fishData.name %>
              </option>
              <% }) %>
            </select>
            <label for="fish-length">Length(inches):</label>
            <input type="number" name="length" id="fish-length" min="0">
            <label for="fish-caughtD">Caught:</label>
            <input type="date" name="caughtDate" id="fish-caughtD" value="<%= caughtDate %>">
            <button type="submit">Add Fish</button>
        </form>
      </div>
    </section>
  <% } %>
</main>

<%- include('../partials/footer') %>
